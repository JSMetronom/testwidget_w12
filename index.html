<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaming Events Kalender</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .glow {
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        .glow-hover:hover {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .calendar-day {
            transition: all 0.3s ease;
        }
        
        .calendar-day:hover {
            background: linear-gradient(135deg, #00ffff20, #ff00ff20);
            transform: scale(1.05);
        }
        
        .event-dot {
            width: 8px;
            height: 8px;
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .modal-backdrop {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.8);
        }
        
        .neon-border {
            border: 2px solid transparent;
            background: linear-gradient(45deg, #00ffff, #ff00ff) border-box;
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: exclude;
        }
    </style>
</head>
<body class="min-h-screen text-white">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-4xl font-black text-white">
                üéÆ LUMMERBOYS EVENTS
            </h1>
            <button id="addEventBtn" class="bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-600 hover:to-purple-700 px-6 py-3 rounded-lg font-bold glow glow-hover transition-all duration-300">
                ‚ö° Event Hinzuf√ºgen
            </button>
        </div>

        <!-- Calendar Navigation -->
        <div class="flex justify-between items-center mb-6">
            <button id="prevMonth" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg glow-hover transition-all duration-300">
                ‚Üê Zur√ºck
            </button>
            <h2 id="currentMonth" class="text-2xl font-bold text-white"></h2>
            <button id="nextMonth" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg glow-hover transition-all duration-300">
                Weiter ‚Üí
            </button>
        </div>

        <!-- Calendar Grid -->
        <div class="bg-gray-900 rounded-xl p-6 glow">
            <!-- Days of Week -->
            <div class="grid grid-cols-7 gap-2 mb-4">
                <div class="text-center font-bold text-white py-2">Mo</div>
                <div class="text-center font-bold text-white py-2">Di</div>
                <div class="text-center font-bold text-white py-2">Mi</div>
                <div class="text-center font-bold text-white py-2">Do</div>
                <div class="text-center font-bold text-white py-2">Fr</div>
                <div class="text-center font-bold text-white py-2">Sa</div>
                <div class="text-center font-bold text-white py-2">So</div>
            </div>
            
            <!-- Calendar Days -->
            <div id="calendarGrid" class="grid grid-cols-7 gap-2">
                <!-- Days will be generated by JavaScript -->
            </div>
        </div>

        <!-- Events List -->
        <div class="mt-8">
            <h3 class="text-2xl font-bold text-white mb-4">üìÖ Kommende Events</h3>
            <div id="eventsList" class="space-y-3">
                <!-- Events will be displayed here -->
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-gray-900 rounded-xl p-8 max-w-md w-full mx-4 neon-border">
            <h3 class="text-2xl font-bold text-cyan-400 mb-6 text-center">üîê Passwort erforderlich</h3>
            <input type="password" id="passwordInput" placeholder="Passwort eingeben..." 
                   class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none mb-6">
            <div class="flex gap-4">
                <button id="cancelPassword" class="flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold transition-all duration-300">
                    Abbrechen
                </button>
                <button id="confirmPassword" class="flex-1 bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-600 hover:to-purple-700 py-3 rounded-lg font-bold glow-hover transition-all duration-300">
                    Best√§tigen
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-gray-900 rounded-xl p-8 max-w-md w-full mx-4 neon-border">
            <h3 class="text-2xl font-bold text-red-400 mb-6 text-center">üóëÔ∏è Event l√∂schen</h3>
            <p class="text-gray-300 mb-4 text-center">Passwort eingeben um Event zu l√∂schen:</p>
            <input type="password" id="deletePasswordInput" placeholder="Passwort eingeben..." 
                   class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-red-400 focus:outline-none mb-6">
            <div class="flex gap-4">
                <button id="cancelDelete" class="flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold transition-all duration-300">
                    Abbrechen
                </button>
                <button id="confirmDelete" class="flex-1 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 py-3 rounded-lg font-bold glow-hover transition-all duration-300">
                    L√∂schen
                </button>
            </div>
        </div>
    </div>

    <!-- Event Creation Modal -->
    <div id="eventModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="bg-gray-900 rounded-xl p-8 max-w-md w-full mx-4 neon-border">
            <h3 class="text-2xl font-bold text-purple-400 mb-6 text-center">‚ö° Neues Event erstellen</h3>
            <div class="space-y-4">
                <input type="text" id="eventTitle" placeholder="Event Titel..." 
                       class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none">
                <input type="date" id="eventDate" 
                       class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none">
                <input type="time" id="eventTime" 
                       class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none">
                <textarea id="eventDescription" placeholder="Beschreibung (optional)..." rows="3"
                          class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none resize-none"></textarea>
            </div>
            <div class="flex gap-4 mt-6">
                <button id="cancelEvent" class="flex-1 bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold transition-all duration-300">
                    Abbrechen
                </button>
                <button id="saveEvent" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 py-3 rounded-lg font-bold glow-hover transition-all duration-300">
                    Speichern
                </button>
            </div>
        </div>
    </div>

    <script>
        class GamingCalendar {
            constructor() {
                this.currentDate = new Date();
                this.events = [];
                this.correctPassword = 'CrusherJS';
                this.eventToDelete = null;
                this.init();
            }

            async init() {
                this.events = await this.loadEvents();
                this.renderCalendar();
                this.renderEventsList();
                this.bindEvents();
            }

            bindEvents() {
                document.getElementById('addEventBtn').addEventListener('click', () => this.showPasswordModal());
                document.getElementById('prevMonth').addEventListener('click', () => this.previousMonth());
                document.getElementById('nextMonth').addEventListener('click', () => this.nextMonth());
                
                // Password modal events
                document.getElementById('cancelPassword').addEventListener('click', () => this.hidePasswordModal());
                document.getElementById('confirmPassword').addEventListener('click', () => this.checkPassword());
                document.getElementById('passwordInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.checkPassword();
                });

                // Event modal events
                document.getElementById('cancelEvent').addEventListener('click', () => this.hideEventModal());
                document.getElementById('saveEvent').addEventListener('click', () => this.saveNewEvent());

                // Delete modal events
                document.getElementById('cancelDelete').addEventListener('click', () => this.hideDeleteModal());
                document.getElementById('confirmDelete').addEventListener('click', () => this.confirmDeleteEvent());
                document.getElementById('deletePasswordInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.confirmDeleteEvent();
                });
            }

            showPasswordModal() {
                document.getElementById('passwordModal').classList.remove('hidden');
                document.getElementById('passwordModal').classList.add('flex');
                document.getElementById('passwordInput').focus();
            }

            hidePasswordModal() {
                document.getElementById('passwordModal').classList.add('hidden');
                document.getElementById('passwordModal').classList.remove('flex');
                document.getElementById('passwordInput').value = '';
            }

            checkPassword() {
                const password = document.getElementById('passwordInput').value;
                if (password === this.correctPassword) {
                    this.hidePasswordModal();
                    this.showEventModal();
                } else {
                    document.getElementById('passwordInput').style.borderColor = '#ef4444';
                    document.getElementById('passwordInput').placeholder = 'Falsches Passwort!';
                    document.getElementById('passwordInput').value = '';
                    setTimeout(() => {
                        document.getElementById('passwordInput').style.borderColor = '#4b5563';
                        document.getElementById('passwordInput').placeholder = 'Passwort eingeben...';
                    }, 2000);
                }
            }

            showEventModal() {
                document.getElementById('eventModal').classList.remove('hidden');
                document.getElementById('eventModal').classList.add('flex');
                document.getElementById('eventTitle').focus();
                
                // Set default date to today
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('eventDate').value = today;
            }

            hideEventModal() {
                document.getElementById('eventModal').classList.add('hidden');
                document.getElementById('eventModal').classList.remove('flex');
                this.clearEventForm();
            }

            clearEventForm() {
                document.getElementById('eventTitle').value = '';
                document.getElementById('eventDate').value = '';
                document.getElementById('eventTime').value = '';
                document.getElementById('eventDescription').value = '';
            }

            async saveNewEvent() {
                const title = document.getElementById('eventTitle').value.trim();
                const date = document.getElementById('eventDate').value;
                const time = document.getElementById('eventTime').value;
                const description = document.getElementById('eventDescription').value.trim();

                if (!title || !date) {
                    alert('Bitte Titel und Datum eingeben!');
                    return;
                }

                const event = {
                    id: Date.now(),
                    title,
                    date,
                    time,
                    description,
                    created: new Date().toISOString()
                };

                this.events.push(event);
                await this.saveEvents();
                this.renderCalendar();
                this.renderEventsList();
                this.hideEventModal();
            }

            previousMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                this.renderCalendar();
            }

            nextMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                this.renderCalendar();
            }

            renderCalendar() {
                const monthNames = [
                    'Januar', 'Februar', 'M√§rz', 'April', 'Mai', 'Juni',
                    'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'
                ];

                document.getElementById('currentMonth').textContent = 
                    `${monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`;

                const firstDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);
                const lastDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - (firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1));

                const calendarGrid = document.getElementById('calendarGrid');
                calendarGrid.innerHTML = '';

                for (let i = 0; i < 42; i++) {
                    const cellDate = new Date(startDate);
                    cellDate.setDate(startDate.getDate() + i);
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = 'calendar-day bg-gray-800 rounded-lg p-3 min-h-[80px] cursor-pointer relative';
                    
                    if (cellDate.getMonth() !== this.currentDate.getMonth()) {
                        dayElement.classList.add('opacity-30');
                    }

                    if (this.isToday(cellDate)) {
                        dayElement.classList.add('bg-white', 'text-black');
                    }

                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'font-bold text-sm';
                    dayNumber.textContent = cellDate.getDate();
                    dayElement.appendChild(dayNumber);

                    // Add event indicators
                    const dayEvents = this.getEventsForDate(cellDate);
                    if (dayEvents.length > 0) {
                        const eventContainer = document.createElement('div');
                        eventContainer.className = 'mt-1 space-y-1';
                        
                        dayEvents.slice(0, 2).forEach(event => {
                            const eventDot = document.createElement('div');
                            eventDot.className = 'event-dot';
                            eventContainer.appendChild(eventDot);
                        });

                        if (dayEvents.length > 2) {
                            const moreText = document.createElement('div');
                            moreText.className = 'text-xs text-white';
                            moreText.textContent = `+${dayEvents.length - 2}`;
                            eventContainer.appendChild(moreText);
                        }

                        dayElement.appendChild(eventContainer);
                    }

                    calendarGrid.appendChild(dayElement);
                }
            }

            renderEventsList() {
                const eventsList = document.getElementById('eventsList');
                const upcomingEvents = this.events
                    .filter(event => new Date(event.date) >= new Date().setHours(0, 0, 0, 0))
                    .sort((a, b) => new Date(a.date) - new Date(b.date))
                    .slice(0, 5);

                if (upcomingEvents.length === 0) {
                    eventsList.innerHTML = '<div class="text-gray-400 text-center py-8">Keine kommenden Events</div>';
                    return;
                }

                eventsList.innerHTML = upcomingEvents.map(event => {
                    const eventDate = new Date(event.date);
                    const formattedDate = eventDate.toLocaleDateString('de-DE', {
                        weekday: 'short',
                        day: '2-digit',
                        month: '2-digit'
                    });

                    return `
                        <div class="bg-gray-800 rounded-lg p-4 glow-hover transition-all duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="font-bold text-lg text-white">${event.title}</h4>
                                    <p class="text-white">${formattedDate} ${event.time ? `um ${event.time}` : ''}</p>
                                    ${event.description ? `<p class="text-white mt-2">${event.description}</p>` : ''}
                                </div>
                                <button onclick="calendar.requestDeleteEvent(${event.id})" class="text-red-400 hover:text-red-300 ml-4">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            requestDeleteEvent(eventId) {
                this.eventToDelete = eventId;
                this.showDeleteModal();
            }

            showDeleteModal() {
                document.getElementById('deleteModal').classList.remove('hidden');
                document.getElementById('deleteModal').classList.add('flex');
                document.getElementById('deletePasswordInput').focus();
            }

            hideDeleteModal() {
                document.getElementById('deleteModal').classList.add('hidden');
                document.getElementById('deleteModal').classList.remove('flex');
                document.getElementById('deletePasswordInput').value = '';
                this.eventToDelete = null;
            }

            async confirmDeleteEvent() {
                const password = document.getElementById('deletePasswordInput').value;
                if (password === this.correctPassword) {
                    this.events = this.events.filter(event => event.id !== this.eventToDelete);
                    await this.saveEvents();
                    this.renderCalendar();
                    this.renderEventsList();
                    this.hideDeleteModal();
                } else {
                    document.getElementById('deletePasswordInput').style.borderColor = '#ef4444';
                    document.getElementById('deletePasswordInput').placeholder = 'Falsches Passwort!';
                    document.getElementById('deletePasswordInput').value = '';
                    setTimeout(() => {
                        document.getElementById('deletePasswordInput').style.borderColor = '#4b5563';
                        document.getElementById('deletePasswordInput').placeholder = 'Passwort eingeben...';
                    }, 2000);
                }
            }

            getEventsForDate(date) {
                const dateString = date.toISOString().split('T')[0];
                return this.events.filter(event => event.date === dateString);
            }

            isToday(date) {
                const today = new Date();
                return date.toDateString() === today.toDateString();
            }

            async loadEvents() {
                try {
                    const response = await fetch('api.php?action=get');
                    const data = await response.json();
                    
                    if (data.success) {
                        return data.events || [];
                    } else {
                        console.error('Error loading events:', data.error);
                        return this.loadLocalEvents(); // Fallback to local storage
                    }
                } catch (error) {
                    console.error('Network error:', error);
                    return this.loadLocalEvents(); // Fallback to local storage
                }
            }

            async saveEvents() {
                try {
                    const response = await fetch('api.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'save',
                            events: this.events
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (!data.success) {
                        console.error('Error saving events:', data.error);
                        this.saveLocalEvents(); // Fallback to local storage
                    }
                } catch (error) {
                    console.error('Network error:', error);
                    this.saveLocalEvents(); // Fallback to local storage
                }
            }

            loadLocalEvents() {
                const saved = localStorage.getItem('lummerboyEvents');
                return saved ? JSON.parse(saved) : [];
            }

            saveLocalEvents() {
                localStorage.setItem('lummerboyEvents', JSON.stringify(this.events));
            }
        }

        // Initialize calendar
        const calendar = new GamingCalendar();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97201087236ebb5c',t:'MTc1NTY3Mzc2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
